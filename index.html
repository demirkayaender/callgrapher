<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Callgraph Viewer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-project-diagram"></i> Callgraph Viewer</h1>
            <p class="subtitle">Interactive visualization of DOT callgraphs</p>
        </header>

        <div class="controls-panel">
            <div class="file-upload-section">
                <label for="file-input" class="file-label">
                    <span class="upload-icon"><i class="fas fa-diagram-project"></i></span>
                    <span class="upload-text">Generate CallGraph</span>
                </label>
                <input type="file" id="file-input" accept=".dot,.gv" />
                <span class="file-name" id="file-name">No dot file selected</span>
                <button id="generate-button" class="btn btn-primary" title="Generate DOT file from Go folder">
                    <i class="fas fa-code"></i> Generate DOT File
                </button>
                <span class="file-name" id="generate-status">No file/folder selected</span>
            </div>

            <div class="button-group">
                <button id="collapse-all-button" class="btn btn-primary" title="Collapse All">
                    <i class="fas fa-compress"></i>
                </button>
                <button id="expand-all-button" class="btn btn-primary" title="Expand All">
                    <i class="fas fa-expand"></i>
                </button>
                <button id="help-button" class="btn btn-secondary" title="Help">
                    <i class="fas fa-question-circle"></i>
                </button>
                <button id="fit-button" class="btn btn-secondary" title="Fit to View">
                    <i class="fas fa-magnifying-glass-minus"></i>
                </button>
                <button id="zoom-text-button" class="btn btn-secondary" title="Zoom to Text">
                    <i class="fas fa-magnifying-glass-plus"></i>
                </button>
                <button id="reset-button" class="btn btn-secondary" title="Reset Layout">
                    <i class="fas fa-redo"></i>
                </button>
                <button id="export-button" class="btn btn-secondary" title="Export PNG">
                    <i class="fas fa-download"></i>
                </button>
            </div>

            <div class="info-panel">
                <div class="info-item">
                    <span class="info-label">Nodes:</span>
                    <span id="node-count" class="info-value">0</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Edges:</span>
                    <span id="edge-count" class="info-value">0</span>
                </div>
            </div>
        </div>

        <div class="graph-container">
            <div id="graph-canvas"></div>
            <div class="help-overlay" id="help-overlay">
                <div class="help-content">
                    <h3><i class="fas fa-lightbulb"></i> Quick Guide</h3>
                    <ul>
                        <li><strong>Collapse All button</strong> - show only entry functions</li>
                        <li><strong>Expand All button</strong> - show full graph</li>
                        <li><strong>Fit to View button</strong> - zoom to see entire graph</li>
                        <li><strong>Zoom to Text button</strong> - zoom to readable text size</li>
                        <li><strong>Right-click nodes</strong> for collapse/expand options</li>
                        <li><strong>Double-click nodes</strong> to collapse/expand all connections</li>
                        <li><strong>Drag nodes</strong> to reposition them</li>
                        <li><strong>Scroll</strong> to zoom in/out</li>
                        <li><strong>Drag canvas</strong> to pan around</li>
                        <li><strong>Click node</strong> to see details</li>
                        <li><strong>Press Esc</strong> or <strong>click outside</strong> to close this guide</li>
                    </ul>
                    <button id="close-help" class="btn btn-primary">Got it!</button>
                </div>
            </div>
        </div>

        <div class="detail-panel" id="detail-panel">
            <div class="detail-header">
                <h3>Node Details</h3>
                <button id="close-detail" class="btn-close">Ã—</button>
            </div>
            <div class="detail-content" id="detail-content">
                <p>Select a node to view details</p>
            </div>
        </div>
    </div>

    <script src="node_modules/vis-network/standalone/umd/vis-network.min.js"></script>
    <script src="go-parser.js"></script>
    <script src="app.js"></script>
</body>
</html>

